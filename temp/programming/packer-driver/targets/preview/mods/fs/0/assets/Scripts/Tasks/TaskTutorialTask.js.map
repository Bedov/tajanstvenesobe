{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/Tasks/TaskTutorialTask.ts"],"names":["_decorator","Enum","ScriptEffects","GenericUI","Task","GameManager","GameStatuType","JSONimage","JSONquestTekst","ccclass","property","TypeOfTask","TaskTutorialTask","String","Boolean","type","start","schedule","isItMyTimeForDownloading","checkpointLock","checkpointCheck","taskManager","node","children","indexOf","parent","getInstance","startProgress","tutorialFinishCheck","orderNumber","downloadedCheckpoint","downloadStarted","taskType","tekstType","getTekstRemotely","imageType","getImageRemotely","unschedule","remoteName","jsonLoader","fetchQuestTekst","toString","tekstObject","fetchImageQuestTekst","imageObject","detectType","_moveTutorialEndBool","_lookTutorialEndBool","executed","showUI","gameStatus","gamePaused","update","loadingHandler","turnOnLoading","scheduleOnce","showTask","console","log","turnOffLoading","genericUI","active","getComponent","fadeInActive","turnOnGenericTaskJSONwithReturn","genericUIimage","turnOnGenericTaskJSONimagewithReturn","subtitle","undefined","fadeOutActive"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, director, Collider, game, Canvas, Enum, find, Game } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\nimport { TaskManager } from \"./TaskManager\";\r\nimport { ScriptEffects } from \"../Utilities/ScriptEffects\";\r\nimport { GenericUI } from \"../Utilities/GenericUI\";\r\nimport { DetectTypeOfDevice } from \"../DetectTypeOfDevice\";\r\nimport { Task } from './Task';\r\nimport { GameManager, GameStatuType } from '../GameManager';\r\nimport { JSONimage, JSONquestTekst } from '../RemoteScripts/JSONloader';\r\nimport { GlobalManager } from '../GlobalManager';\r\nimport { DetectTypeOfDeviceElevator } from '../DetectTypeOfDeviceElevator';\r\n\r\nexport enum TypeOfTask {\r\n    tekstType=    0,\r\n    imageType=   1,\r\n    }\r\n\r\n@ccclass('TaskTutorialTask')\r\nexport class TaskTutorialTask extends Task {\r\n\r\n    myTimeHasCome = true;\r\n\r\n    @property(String)\r\n    remoteName!: String;\r\n\r\n    @property(Boolean)\r\n    elevatorScript = false;\r\n    \r\n    @property ({type:Enum(TypeOfTask)})\r\n    taskType:TypeOfTask = TypeOfTask.tekstType;\r\n\r\n    tekstObject: JSONquestTekst = new JSONquestTekst ;\r\n    imageObject: JSONimage = new JSONimage ;\r\n\r\n\r\n    start(){\r\n        \r\n        this.schedule(this.isItMyTimeForDownloading, 0.1);\r\n\r\n\r\n        if(this.checkpointLock)\r\n            this.schedule(this.checkpointCheck, 0.1);\r\n\r\n     \r\n    }\r\n\r\n    checkpointCheck() {\r\n        if( this.taskManager.node.children.indexOf(this.node.parent!) ==  GameManager.getInstance().startProgress )\r\n            this.schedule(this.tutorialFinishCheck, 0.1);\r\n    }\r\n\r\n    isItMyTimeForDownloading() {\r\n        if(this.orderNumber <= GameManager.getInstance().downloadedCheckpoint && !this.downloadStarted ) {\r\n            if(this.taskType == TypeOfTask.tekstType)\r\n                this.getTekstRemotely();\r\n            if(this.taskType == TypeOfTask.imageType)\r\n                this.getImageRemotely();\r\n\r\n                this.downloadStarted = true;\r\n\r\n            this.unschedule(this.isItMyTimeForDownloading);\r\n        }\r\n            \r\n    }\r\n\r\n    getTekstRemotely() {\r\n        if(this.remoteName != \"\") {\r\n            GameManager.getInstance().jsonLoader?.fetchQuestTekst(this.remoteName.toString(), this.tekstObject)!;\r\n        }\r\n    }\r\n\r\n    getImageRemotely() {\r\n        if(this.remoteName != \"\") {\r\n            GameManager.getInstance().jsonLoader?.fetchImageQuestTekst(this.remoteName.toString(), this.imageObject)!;\r\n        }\r\n    }\r\n\r\n    tutorialFinishCheck() {\r\n        if(GameManager.getInstance().detectType?._moveTutorialEndBool && GameManager.getInstance().detectType?._lookTutorialEndBool && !this.executed ) {\r\n            this.showUI();\r\n            GameManager.getInstance().gameStatus = GameStatuType.gamePaused;\r\n\r\n            this.unschedule(this.tutorialFinishCheck);\r\n        }\r\n    }\r\n \r\n    update() { \r\n        if(this.checkpointLock)\r\n            if( this.taskManager.node.children.indexOf(this.node.parent!) !=  GameManager.getInstance().startProgress ) {\r\n                \r\n            \r\n                return;\r\n            }\r\n        \r\n    }\r\n\r\n    showUI (){\r\n        \r\n        if(GameManager.getInstance().downloadedCheckpoint <= this.orderNumber) {\r\n            GameManager.getInstance().loadingHandler?.turnOnLoading();\r\n            this.scheduleOnce(this.showTask, 0.2);\r\n            console.log(\"DownloadedCheckpoint : \" + GameManager.getInstance().downloadedCheckpoint);\r\n\r\n            console.log(\"this.orderNumber : \" + this.orderNumber);\r\n            return;\r\n        }\r\n\r\n        super.showTask();\r\n\r\n\r\n\r\n        GameManager.getInstance().loadingHandler?.turnOffLoading();\r\n\r\n        \r\n        \r\n        if(this.taskType == TypeOfTask.tekstType) {\r\n            this.taskManager.genericUI!.active = true;\r\n            this.taskManager.genericUI!.getComponent(ScriptEffects)!.fadeInActive();\r\n            this.taskManager.genericUI!.getComponent(GenericUI)!.turnOnGenericTaskJSONwithReturn(this.tekstObject, this); \r\n        }\r\n        if(this.taskType == TypeOfTask.imageType) {\r\n            this.taskManager.genericUIimage!.active = true;\r\n            this.taskManager.genericUIimage!.getComponent(ScriptEffects)!.fadeInActive();\r\n            this.taskManager.genericUIimage!.getComponent(GenericUI)!.turnOnGenericTaskJSONimagewithReturn(this.imageObject, this, false); \r\n        }\r\n\r\n        if(this.taskManager.subtitle != undefined)\r\n            this.taskManager.subtitle!.getComponent(ScriptEffects)?.fadeOutActive();\r\n\r\n\r\n    }\r\n\r\n \r\n\r\n\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}