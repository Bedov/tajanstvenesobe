{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/Tasks/TaskManager.ts"],"names":["_decorator","Component","Node","Vec3","Quat","Animation","Prefab","instantiate","Checkpoint","FollowGoForward","GameManager","ButtonDisabler","Task","ccclass","property","TaskManager","type","onLoad","checkpoints","node","children","start","checkDoneTasks","getTasks","tasks","forEach","checkpoint","element","getComponent","undefined","push","element2","refreshExecutedTasks","indexOf","getInstance","Progress","checkReadinesForTasks","checkReadienes","index","Number","console","log","task","executed","checkActivityOfHelpButton","getDirection","Canvas","getChildByName","lockedByOutside","arrow","play","Player","getDirectionFollow","itemPosition","QuestionItem","worldPosition","node1","followPrefab","setTarget","parent","position","lookAt","Vec3EulerRot","toEuler","rotation","toString","readAgain","taskInCheckpoint","Question","uvodniTask","helpButton","active"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, Game, Vec3, Quat, quat, Animation, Prefab, director, instantiate} from 'cc';\r\nimport { Checkpoint } from '../Checkpoint/Checkpoint';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = TaskManager\r\n * DateTime = Thu Nov 18 2021 00:16:36 GMT+0100 (Central European Standard Time)\r\n * Author = stickandrope\r\n * FileBasename = TaskManager.ts\r\n * FileBasenameNoExtension = TaskManager\r\n * URL = db://assets/Scripts/TaskManager.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n import { DetectTypeOfDevice } from \"../DetectTypeOfDevice\";\r\nimport { FollowGoForward } from '../FollowGoForward';\r\nimport { GameManager } from '../GameManager';\r\nimport { ButtonDisabler } from '../Utilities/ButtonDisabler';\r\nimport { GenericUI } from '../Utilities/GenericUI';\r\nimport { Task } from './Task';\r\nimport { TaskABCquestion } from './TaskABCquestion';\r\n \r\n \r\n@ccclass('TaskManager')\r\nexport class TaskManager extends Component {\r\n\r\n    @property({type: Node})\r\n    public genericUI: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public genericUIimage: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public genericUIABC: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public genericUIinput: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public canvas: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public gameManager: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public subtitle: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public helpButton: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public arrow: Node | null = null;\r\n\r\n    @property({type: Node})\r\n    public follow: Node | null = null;\r\n\r\n    @property({type: Prefab})\r\n    public followPrefab: Node | null = null;\r\n\r\n    checkpoints: Node[] = [];\r\n\r\n\r\n    onLoad () {\r\n        this.checkpoints = this.node.children; \r\n    }\r\n\r\n    start() {\r\n        this.checkDoneTasks();\r\n    }\r\n\r\n    getTasks() {\r\n\r\n        var tasks: Node[] = [];\r\n\r\n        this.checkpoints.forEach(checkpoint => {\r\n            checkpoint.children.forEach(element => {\r\n                if(element.getComponent(Task) != undefined)\r\n                    tasks.push(element);\r\n\r\n                element.children.forEach(element2 => {\r\n                    if(element.getComponent(Task) != undefined)\r\n                        tasks.push(element2);\r\n                });\r\n            });\r\n        });\r\n\r\n        return tasks;\r\n    }\r\n\r\n    refreshExecutedTasks(checkpoint: Node) {\r\n        \r\n        if(this.checkpoints.indexOf(checkpoint) != undefined)\r\n            if(this.checkpoints.indexOf(checkpoint) > GameManager.getInstance().Progress)\r\n                GameManager.getInstance().Progress = this.checkpoints.indexOf(checkpoint);\r\n        this.checkReadinesForTasks();\r\n    }\r\n\r\n    checkReadinesForTasks() {\r\n        var children = this.getTasks();\r\n\r\n        children.forEach(element => {\r\n            if(element.getComponent(Task) )\r\n            element.getComponent(Task)?.checkReadienes();\r\n        });\r\n    }\r\n\r\n    checkDoneTasks() {\r\n        var children = this.getTasks();\r\n\r\n        if(GameManager.getInstance().Progress == 0)\r\n            return;\r\n\r\n        for (let index = Number(GameManager.getInstance().Progress) -1 ; index >= 0; index--) {\r\n            console.log(\"PETLJA \" + index);\r\n            \r\n            const checkpoint = this.checkpoints[index];\r\n            checkpoint.children.forEach(task => {\r\n                task.getComponent(Task)!.executed = true;\r\n \r\n            });\r\n            \r\n        }\r\n\r\n        this.checkReadinesForTasks();\r\n\r\n        this.checkActivityOfHelpButton();\r\n        /*\r\n        children.forEach(task => {\r\n\r\n            if( GameManager.getInstance().Progress > task.getComponent(Task)!.checkPointBelong)\r\n            task.getComponent(Task)!.executed = true;\r\n\r\n        }); */\r\n\r\n\r\n    }\r\n    getDirection() {\r\n        \r\n        GameManager.getInstance().Canvas!.getChildByName(\"BottomUI\")!.getChildByName(\"HelpNavigation\")!.getComponent(ButtonDisabler)!.lockedByOutside = true;\r\n        \r\n        if(this.arrow != null)\r\n            this.arrow!.getComponent(Animation)?.play(\"ScaleIn\");\r\n        else\r\n            GameManager.getInstance().Player!.getChildByName(\"Arrow\")!.getComponent(Animation)?.play(\"ScaleIn\");\r\n\r\n    }\r\n\r\n    getDirectionFollow() {\r\n        var itemPosition: Vec3 = new Vec3( this.checkpoints[ Number(GameManager.getInstance().Progress)].getComponent(Checkpoint)!.QuestionItem!.worldPosition ) ;\r\n    \r\n\r\n        const node1 = instantiate(this.followPrefab);\r\n        node1!.getComponent(FollowGoForward)!.setTarget( this.checkpoints[ Number(GameManager.getInstance().Progress)].getComponent(Checkpoint)!.QuestionItem!);\r\n        //let node1: Node= instantiate(this.followPrefab);  //instantiate(this.follow);\r\n\r\n        node1!.parent = this.node;\r\n        node1!.position = new Vec3( GameManager.getInstance().Player!.getChildByName(\"Arrow\")!.worldPosition );\r\n        \r\n        node1!.lookAt( itemPosition);\r\n\r\n        var Vec3EulerRot: Vec3 = new Vec3;\r\n        Quat.toEuler(Vec3EulerRot, node1!.rotation );\r\n\r\n        console.log(\"Rotation \" + Vec3EulerRot.toString() );\r\n        \r\n    }\r\n\r\n    readAgain() {\r\n        this.checkpoints[ Number(GameManager.getInstance().Progress)].children.forEach(taskInCheckpoint => {\r\n            if( this.checkpoints[ Number(GameManager.getInstance().Progress)].getComponent(Checkpoint)?.Question != taskInCheckpoint ) {\r\n                if(taskInCheckpoint.getComponent(Task)!.uvodniTask == false)\r\n                    taskInCheckpoint.getComponent(Task)!.executed = false;\r\n                \r\n            }\r\n        });\r\n        this.checkReadinesForTasks();\r\n    }\r\n\r\n    checkActivityOfHelpButton() {\r\n        if(this.checkpoints[ Number(GameManager.getInstance().Progress)].getComponent(Checkpoint)?.QuestionItem != undefined)\r\n            this.helpButton!.active = false;\r\n        else\r\n            this.helpButton!.active = true;\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}