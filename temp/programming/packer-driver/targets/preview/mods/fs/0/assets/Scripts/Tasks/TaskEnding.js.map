{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/Tasks/TaskEnding.ts"],"names":["_decorator","director","macro","Task","elevator","GlobalManager","levelObject","levelStatus","ccclass","property","TaskEnding","Boolean","start","schedule","checkExecution","REPEAT_FOREVER","update","isItOkToExecute","showTask","unschedule","getInstance","activeLevelData","levelProgress","status","finished","indexOfCurrentScene","levelsArray","indexOf","console","log","sceneName","length","unlocked","findGeneralProgress","loadScene","executed","findSceneDataByName","returnLevel","forEach","element"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAA6BC,MAAAA,Q,OAAAA,Q;AAAkCC,MAAAA,K,OAAAA,K;;AAO/DC,MAAAA,I,iBAAAA,I;;AAGAC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,a,iBAAAA,a;AAAeC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,W,iBAAAA,W;;;;;;;OATzC;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;4BAcjBU,U,WADZF,OAAO,CAAC,YAAD,C,UAMHC,QAAQ,CAAEE,OAAF,C,oCANb,MACaD,UADb;AAAA;AAAA,wBACqC;AAAA;AAAA;;AAAA,iDAEjB,IAFiB;;AAAA;AAAA;;AAQjCE,QAAAA,KAAK,GAAE;AACH,eAAKC,QAAL,CAAc,KAAKC,cAAnB,EAAmC,GAAnC,EAAwCZ,KAAK,CAACa,cAA9C,EADG,CAGH;AAEH;;AAIDC,QAAAA,MAAM,GAAG,CAER;;AAEDF,QAAAA,cAAc,GAAG;AACb,cAAG,KAAKG,eAAL,EAAH,EAA2B;AACvB,iBAAKC,QAAL;AACA,iBAAKC,UAAL,CAAgB,KAAKL,cAArB;AACH;AAEJ;;AAGDI,QAAAA,QAAQ,GAAG;AACP;AAAA;AAAA,8CAAcE,WAAd,GAA4BC,eAA5B,CAA4CC,aAA5C,GAA4D,CAA5D;AACA;AAAA;AAAA,8CAAcF,WAAd,GAA4BC,eAA5B,CAA4CE,MAA5C,GAAqD;AAAA;AAAA,0CAAYC,QAAjE;AACA,cAAIC,mBAAmB,GAAG;AAAA;AAAA,8CAAcL,WAAd,GAA4BM,WAA5B,CAAwCC,OAAxC,CAAgD;AAAA;AAAA,8CAAcP,WAAd,GAA4BC,eAA5E,CAA1B;AAEAO,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAA+B;AAAA;AAAA,8CAAcT,WAAd,GAA4BC,eAA5B,CAA4CS,SAAvF;AACAF,UAAAA,OAAO,CAACC,GAAR,CAAY,yBAAyBJ,mBAArC;AACAG,UAAAA,OAAO,CAACC,GAAR,CAAY,qDAAqD;AAAA;AAAA,8CAAcT,WAAd,GAA4BM,WAA5B,CAAwCK,MAAzG;AAEA,cAAGN,mBAAmB,GAAG;AAAA;AAAA,8CAAcL,WAAd,GAA4BM,WAA5B,CAAwCK,MAAjE,EACI;AAAA;AAAA,8CAAcX,WAAd,GAA4BM,WAA5B,CAAwCD,mBAAmB,GAAG,CAA9D,EAAiEF,MAAjE,GAA0E;AAAA;AAAA,0CAAYS,QAAtF;AAKJJ,UAAAA,OAAO,CAACC,GAAR,CAAY,0CAA0C;AAAA;AAAA,8CAAcT,WAAd,GAA4Ba,mBAA5B,EAAtD;AACA;AAAA;AAAA,8CAAcb,WAAd,GAA4BC,eAA5B;AAAA;AAAA,mCAhBO,CAgBkD;;AACzD;AAAA;AAAA,8CAAcD,WAAd,GAA4BC,eAA5B,CAA4CC,aAA5C,GAA4D,CAA5D;AAEArB,UAAAA,QAAQ,CAACiC,SAAT,CAAmB,eAAnB;AAEA,eAAKC,QAAL,GAAgB,IAAhB;AACH;;AAEDC,QAAAA,mBAAmB,CAACN,SAAD,EAAoB;AACnC,cAAIJ,WAAW,GAAG;AAAA;AAAA,8CAAcN,WAAd,GAA4BM,WAA9C;AAEA,cAAIW,WAAW,GAAG;AAAA;AAAA,2CAAlB;AAEAX,UAAAA,WAAW,CAACY,OAAZ,CAAoBC,OAAO,IAAI;AAC3B,gBAAGA,OAAO,CAACT,SAAR,IAAqBA,SAAxB,EACEO,WAAW,GAAGE,OAAd;AACL,WAHD;AAKA,iBAAOF,WAAP;AACD;;AAjE8B,O;;;;;iBAMnB,K;;;AA+DlB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["\r\nimport { _decorator, Component, Node, director, Collider, game, Canvas, macro, Sprite, Enum } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\nimport { TaskManager } from \"./TaskManager\";\r\nimport { ScriptEffects } from \"../Utilities/ScriptEffects\";\r\nimport { GenericUI } from \"../Utilities/GenericUI\";\r\nimport { DetectTypeOfDevice } from \"../DetectTypeOfDevice\";\r\nimport { Task } from './Task';\r\nimport { GameManager } from '../GameManager';\r\nimport { JSONimage, JSONquestTekst } from '../RemoteScripts/JSONloader';\r\nimport { elevator, GlobalManager, levelObject, levelStatus } from '../GlobalManager';\r\n\r\n\r\n\r\n@ccclass('TaskEnding')\r\nexport class TaskEnding extends Task {\r\n\r\n    myTimeHasCome = true;\r\n\r\n\r\n    @property (Boolean)\r\n    debugEnding = false;\r\n\r\n    start(){\r\n        this.schedule(this.checkExecution, 0.1, macro.REPEAT_FOREVER);\r\n        \r\n        //this.scheduleOnce(this.fetchTheData, this.orderNumber * 0.05);\r\n        \r\n    }\r\n\r\n\r\n\r\n    update() {\r\n\r\n    }\r\n\r\n    checkExecution() {\r\n        if(this.isItOkToExecute()) {\r\n            this.showTask();\r\n            this.unschedule(this.checkExecution);\r\n        }\r\n            \r\n    }\r\n\r\n\r\n    showTask() {\r\n        GlobalManager.getInstance().activeLevelData.levelProgress = 0;\r\n        GlobalManager.getInstance().activeLevelData.status = levelStatus.finished;\r\n        var indexOfCurrentScene = GlobalManager.getInstance().levelsArray.indexOf(GlobalManager.getInstance().activeLevelData);\r\n\r\n        console.log(\"Task ending active level: \" + GlobalManager.getInstance().activeLevelData.sceneName);\r\n        console.log(\"indexOfCurrentScene \" + indexOfCurrentScene);\r\n        console.log(\"GlobalManager.getInstance().levelsArray.length: \" + GlobalManager.getInstance().levelsArray.length);\r\n\r\n        if(indexOfCurrentScene < GlobalManager.getInstance().levelsArray.length)\r\n            GlobalManager.getInstance().levelsArray[indexOfCurrentScene + 1].status = levelStatus.unlocked;\r\n\r\n\r\n        \r\n\r\n        console.log(\"Task ending,.findGeneralProgress() : \" + GlobalManager.getInstance().findGeneralProgress());\r\n        GlobalManager.getInstance().activeLevelData =  elevator; //  this.findSceneDataByName(\"MainMenuLift1\");\r\n        GlobalManager.getInstance().activeLevelData.levelProgress = 1;\r\n        \r\n        director.loadScene(\"MainMenuLift1\");\r\n\r\n        this.executed = true;\r\n    }\r\n\r\n    findSceneDataByName(sceneName: string) {\r\n        var levelsArray = GlobalManager.getInstance().levelsArray;\r\n        \r\n        var returnLevel = new levelObject;\r\n        \r\n        levelsArray.forEach(element => {\r\n            if(element.sceneName == sceneName) \r\n              returnLevel = element;\r\n        });\r\n  \r\n        return returnLevel;\r\n      }\r\n\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}