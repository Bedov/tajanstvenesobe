{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/Tasks/TaskAutoActiveLocalAudio.ts"],"names":["_decorator","Node","macro","Enum","AudioSource","Task","GameManager","JSONimage","JSONquestTekst","ccclass","property","TypeOfTask","TaskAutoActiveLocalAudio","String","type","start","schedule","checkExecution","REPEAT_FOREVER","isItMyTimeForDownloading","getTekstRemotely","remoteName","getInstance","jsonLoader","fetchQuestTekst","toString","tekstObject","getImageRemotely","fetchImageQuestTekst","imageObject","fetchTheData","taskType","tekstType","imageType","orderNumber","downloadedCheckpoint","downloadStarted","unschedule","update","deltaTime","timerOn","counterForExecution","bellIcon","active","executed","taskCompleted","isItOkToExecute","soundPlayed","showTask","getComponent","play"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAuBC,MAAAA,I,OAAAA,I;AAAwCC,MAAAA,K,OAAAA,K;AAAeC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;;AAOpFC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,S,iBAAAA,S;AAAWC,MAAAA,c,iBAAAA,c;;;;;;;OARd;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBV,U;;iBAWlBW,U;AAAAA,QAAAA,U,CAAAA,U;AAAAA,QAAAA,U,CAAAA,U;SAAAA,U,0BAAAA,U;;0CAMCC,wB,WADZH,OAAO,CAAC,0BAAD,C,UAOHC,QAAQ,CAACG,MAAD,C,UAGRH,QAAQ,CAACT,IAAD,C,UAMRS,QAAQ,CAAE;AAACI,QAAAA,IAAI,EAACX,IAAI,CAACQ,UAAD;AAAV,OAAF,C,oCAhBb,MACaC,wBADb;AAAA;AAAA,wBACmD;AAAA;AAAA;;AAAA,iDAE/B,IAF+B;;AAAA,+CAIjC,KAJiC;;AAAA;;AAAA;;AAAA,uDAYzB,CAZyB;;AAAA,2CAarC,KAbqC;;AAAA;;AAAA,+CAkBjB;AAAA;AAAA,iDAlBiB;;AAAA,+CAmBtB;AAAA;AAAA,uCAnBsB;AAAA;;AAqB/CG,QAAAA,KAAK,GAAE;AACH,eAAKC,QAAL,CAAc,KAAKC,cAAnB,EAAmC,CAAnC,EAAsCf,KAAK,CAACgB,cAA5C;AACA,eAAKF,QAAL,CAAc,KAAKG,wBAAnB,EAA6C,GAA7C;AAEH;;AAGDC,QAAAA,gBAAgB,GAAG;AACf,cAAG,KAAKC,UAAL,IAAmB,EAAtB,EAA0B;AAAA;;AACtB;AAAA;AAAA,4CAAYC,WAAZ,GAA0BC,UAA1B,gFAAsCC,eAAtC,CAAsD,KAAKH,UAAL,CAAgBI,QAAhB,EAAtD,EAAkF,KAAKC,WAAvF;AACH;AACJ;;AAEDC,QAAAA,gBAAgB,GAAG;AACf,cAAG,KAAKN,UAAL,IAAmB,EAAtB,EAA0B;AAAA;;AACtB;AAAA;AAAA,4CAAYC,WAAZ,GAA0BC,UAA1B,kFAAsCK,oBAAtC,CAA2D,KAAKP,UAAL,CAAgBI,QAAhB,EAA3D,EAAuF,KAAKI,WAA5F;AACH;AACJ;;AAEDC,QAAAA,YAAY,GAAG;AACX,cAAG,KAAKC,QAAL,IAAiBpB,UAAU,CAACqB,SAA/B,EACI,KAAKZ,gBAAL;AACJ,cAAG,KAAKW,QAAL,IAAiBpB,UAAU,CAACsB,SAA/B,EACC,KAAKN,gBAAL;AACJ;;AAEDR,QAAAA,wBAAwB,GAAG;AACvB,cAAG,KAAKe,WAAL,IAAoB;AAAA;AAAA,0CAAYZ,WAAZ,GAA0Ba,oBAA9C,IAAsE,CAAC,KAAKC,eAA/E,EAAiG;AAC7F,iBAAKN,YAAL;AACA,iBAAKM,eAAL,GAAuB,IAAvB;AACA,iBAAKC,UAAL,CAAgB,KAAKlB,wBAArB;AACH;AAEJ;;AAEDmB,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAG,KAAKC,OAAR,EACI,KAAKC,mBAAL,IAA4BF,SAA5B,CADJ,KAGI;AAEJ,eAAKG,QAAL,CAAcC,MAAd,GAAuB,IAAvB;;AACA,cAAG,KAAKF,mBAAL,GAA2B,CAA9B,EAAiC;AAC7B,gBAAG,KAAKG,QAAL,IAAiB,KAApB,EACI,KAAKC,aAAL;AACJ,iBAAKL,OAAL,GAAe,KAAf;AACA,iBAAKE,QAAL,CAAcC,MAAd,GAAuB,KAAvB;AACH;AAEJ;;AAED1B,QAAAA,cAAc,GAAG;AACb,cAAG,KAAK6B,eAAL,MAA0B,CAAC,KAAKC,WAAnC,EAAgD;AAC5C,iBAAKC,QAAL;AACA,iBAAKD,WAAL,GAAmB,IAAnB;AACH;AACJ;;AAKDC,QAAAA,QAAQ,GAAG;AAAA;;AAEP,qCAAKC,YAAL,CAAkB7C,WAAlB,2EAAgC8C,IAAhC,GAFO,CAGP;;AACA,cAAG,KAAKN,QAAL,IAAiB,KAApB,EACI,KAAKJ,OAAL,GAAe,IAAf,CALG,CAMP;AAGH;;AA3F8C,O;;;;;;;;;;;;;;;iBAgBzB7B,UAAU,CAACqB,S;;;AAgFrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["\r\nimport { _decorator, Component, Node, director, Collider, game, Canvas, macro, Sprite, Enum, AudioSource } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\nimport { TaskManager } from \"./TaskManager\";\r\nimport { ScriptEffects } from \"../Utilities/ScriptEffects\";\r\nimport { GenericUI } from \"../Utilities/GenericUI\";\r\nimport { DetectTypeOfDevice } from \"../DetectTypeOfDevice\";\r\nimport { Task } from './Task';\r\nimport { GameManager } from '../GameManager';\r\nimport { JSONimage, JSONquestTekst } from '../RemoteScripts/JSONloader';\r\n\r\n\r\nexport enum TypeOfTask {\r\n    tekstType=    0,\r\n    imageType=   1,\r\n    }\r\n\r\n@ccclass('TaskAutoActiveLocalAudio')\r\nexport class TaskAutoActiveLocalAudio extends Task {\r\n\r\n    myTimeHasCome = true;\r\n\r\n    soundPlayed = false;\r\n\r\n    @property(String)\r\n    remoteName!: String;\r\n\r\n    @property(Node)\r\n    bellIcon!: Node;\r\n\r\n    counterForExecution = 0;\r\n    timerOn = false;\r\n\r\n    @property ({type:Enum(TypeOfTask)})\r\n    taskType:TypeOfTask = TypeOfTask.tekstType;\r\n\r\n    tekstObject: JSONquestTekst = new JSONquestTekst ;\r\n    imageObject: JSONimage = new JSONimage ;\r\n\r\n    start(){\r\n        this.schedule(this.checkExecution, 1, macro.REPEAT_FOREVER);\r\n        this.schedule(this.isItMyTimeForDownloading, 0.1);\r\n\r\n    }\r\n\r\n    \r\n    getTekstRemotely() {\r\n        if(this.remoteName != \"\") {\r\n            GameManager.getInstance().jsonLoader?.fetchQuestTekst(this.remoteName.toString(), this.tekstObject)!;\r\n        }\r\n    }\r\n\r\n    getImageRemotely() {\r\n        if(this.remoteName != \"\") {\r\n            GameManager.getInstance().jsonLoader?.fetchImageQuestTekst(this.remoteName.toString(), this.imageObject)!;\r\n        }\r\n    }\r\n\r\n    fetchTheData() {\r\n        if(this.taskType == TypeOfTask.tekstType)\r\n            this.getTekstRemotely();\r\n        if(this.taskType == TypeOfTask.imageType)\r\n         this.getImageRemotely();\r\n    }\r\n\r\n    isItMyTimeForDownloading() {\r\n        if(this.orderNumber <= GameManager.getInstance().downloadedCheckpoint && !this.downloadStarted ) {\r\n            this.fetchTheData();\r\n            this.downloadStarted = true;\r\n            this.unschedule(this.isItMyTimeForDownloading);\r\n        }\r\n            \r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        if(this.timerOn) \r\n            this.counterForExecution += deltaTime;\r\n        else    \r\n            return;\r\n        \r\n        this.bellIcon.active = true;\r\n        if(this.counterForExecution > 6) {\r\n            if(this.executed == false)\r\n                this.taskCompleted();\r\n            this.timerOn = false;\r\n            this.bellIcon.active = false;\r\n        }\r\n\r\n    }\r\n\r\n    checkExecution() {\r\n        if(this.isItOkToExecute() && !this.soundPlayed) {\r\n            this.showTask();\r\n            this.soundPlayed = true;\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    showTask() {\r\n\r\n        this.getComponent(AudioSource)?.play();\r\n        //this.taskCompleted();\r\n        if(this.executed == false)\r\n            this.timerOn = true;\r\n        //this.scheduleOnce(this.taskCompleted(), 6);\r\n\r\n        \r\n    }\r\n\r\n\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}