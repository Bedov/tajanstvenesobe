{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/RemoteScripts/JSONloader.ts"],"names":["JSONtask2","JSONtask1","JSONobject","JSONquestTekst","JSONimage","_decorator","Component","assetManager","AudioClip","SpriteFrame","Texture2D","GameManager","ccclass","property","tasksInProgress","JSONloader","onLoad","gameManager","node","getComponent","schedule","printTasks","console","log","fetchQuestions","folderURL","taskJSON","expectedQuestions","remoteUrlRoot","originUrl","LanguageName","LevelName","index","Number","questionURL","toString","returnQuestion","pop","returnQuestionInput","downloadInProgress","audioURL","loadRemote","err","textAsset","parsedJSON","JSON","parse","question","tacanOdgovor","undefined","audioClip","questionAudio","error","audioIsLoaded","remoteUrl","tempTask","netacanOdgovor1","netacanOdgovor2","push","update","getInstance","downloadedCheckpoint","instance","taskInProgressManager","fetchQuestTekst","questURL","tekstObject","quest","questAudio","fetchImageQuestTekst","imageObject","rootURL","fetchedImage","spriteFrame","texture","image","questImage","constructor","type","tacanOdgovorAudio"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, JsonAsset, assetManager, Game, AudioClip, AudioSource, SpriteFrame, ImageAsset, Texture2D, Sprite, game} from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n//const fs = require('fs');\r\n//import{  fs} from 'fs-extra';\r\n//https://docs.cocos.com/creator/3.1/manual/en/asset/dynamic-load-resources.html\r\n\r\n/**\r\n * Predefined variables\r\n * Name = JSONloader\r\n * DateTime = Fri Nov 26 2021 15:46:48 GMT+0100 (Central European Standard Time)\r\n * Author = stickandrope\r\n * FileBasename = JSONloader.ts\r\n * FileBasenameNoExtension = JSONloader\r\n * URL = db://assets/Scripts/RemoteScripts/JSONloader.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n\r\n//var static instance: JSONloader;\r\nvar tasksInProgress = 0;\r\n\r\n \r\nimport { GameManager } from \"../GameManager\";\r\nimport { GlobalManager } from '../GlobalManager';\r\nimport { Task } from '../Tasks/Task';\r\n\r\n@ccclass('JSONloader')\r\nexport class JSONloader extends Component {\r\n    \r\n    gameManager? : GameManager ;\r\n    downloadTask: number = 0;\r\n\r\n    downloadInProgress = false;\r\n\r\n    public downloadedCheckpoint = -1;\r\n\r\n    originUrl = \"https://stickandrope.com/klett/json\"; \r\n    //originUrl = \"http://abedov.com/json\"; \r\n\r\n    onLoad(){\r\n\r\n        this.gameManager = this.node.getComponent(GameManager)!;\r\n\r\n        this.schedule(this.printTasks, 1);\r\n        \r\n    }\r\n\r\n    printTasks() {\r\n        console.log(\"Tasks in Progress: \" + tasksInProgress);\r\n        \r\n    }\r\n\r\n\r\n    fetchQuestions(folderURL: String, taskJSON: Array<JSONtask1>, expectedQuestions: Number) {\r\n\r\n        let remoteUrlRoot = this.originUrl + \"/\" + this.gameManager?.LanguageName + \"/\" + this.gameManager?.LevelName + \"/\" + folderURL + \"/\" ;\r\n\r\n\r\n        for (let index = 1; index < Number(expectedQuestions) + 1; index++) {\r\n            //console.log(\"URL: \" + remoteUrlRoot + index.toString() + \".txt\");\r\n            var questionURL = remoteUrlRoot + index.toString() + \".txt\";\r\n\r\n            if(!this.returnQuestion(remoteUrlRoot, questionURL, taskJSON, index)) {\r\n                taskJSON.pop();\r\n                \r\n                index = 13;\r\n            }\r\n                \r\n        }\r\n    }\r\n\r\n    returnQuestionInput(questionURL: String, taskJSON: JSONtask2) {\r\n        this.downloadInProgress = true;\r\n\r\n        let remoteUrlRoot = this.originUrl + \"/\" + this.gameManager?.LanguageName + \"/\" + this.gameManager?.LevelName + \"/\" + questionURL;\r\n        var audioURL = this.originUrl + \"/\" + this.gameManager?.LanguageName + \"/\" + this.gameManager?.LevelName + \"/\";\r\n\r\n        try {\r\n            tasksInProgress++;\r\n\r\n             assetManager.loadRemote(remoteUrlRoot.toString(), function (err, textAsset) {\r\n\r\n                 try {\r\n                    var parsedJSON = JSON.parse(textAsset.toString());\r\n                    taskJSON.question = parsedJSON[\"question\"];\r\n                    taskJSON.tacanOdgovor = parsedJSON[\"tacanOdgovor\"];\r\n                    \r\n                    \r\n                    \r\n                    if( parsedJSON[\"questionAudio\"] != undefined)  {\r\n\r\n                        try {\r\n                            //tasksInProgress++;\r\n                            //console.log(\"Task Added 2\");\r\n                            assetManager.loadRemote<AudioClip>(audioURL + parsedJSON[\"questionAudio\"], (AudioClip), (err, audioClip) =>  {\r\n                                taskJSON.questionAudio =  audioClip ;\r\n                                //tasksInProgress--;\r\n                                //console.log(\"Task reduced 2\");\r\n                            });\r\n                            \r\n                        } catch (error) {\r\n                            console.log(\"Zvuk nije dobro ucitan\");\r\n                            taskJSON.audioIsLoaded = false;\r\n                        } \r\n                    } else \r\n                        console.log(\"Ne postoje zvukovi za ovu putanju\");\r\n\r\n                    tasksInProgress--;\r\nconsole.log(\"Task reduced 1\");\r\n                } catch (error) {\r\n                    console.log(\"Nisam nasao trazeno polje za parsiranje\" + error );\r\n                    return false;\r\n                }console.log(\" BITNOOO  \" + taskJSON.questionAudio);\r\n            });\r\n            return true;\r\n        } catch (error) {\r\n            console.log(\"Nisam nasao trazenu adresu za parsiranje 2\" + error );\r\n            return false;\r\n        }\r\n        \r\n\r\n    }\r\n\r\n    returnQuestion(remoteUrlRoot: string, questionURL: string, taskJSON: Array<JSONtask1>, index : number) {\r\n        this.downloadInProgress = true;\r\n        \r\n        let remoteUrl = this.originUrl + \"/\" + this.gameManager?.LevelName  + \"/\" + this.gameManager?.LanguageName + \"/\" + questionURL + \".txt\";\r\n\r\n        try {\r\n\r\n             assetManager.loadRemote(questionURL, function (err, textAsset) {\r\n\r\n                 try {              \r\n                    tasksInProgress++;\r\n                    console.log(\"Task Added 3 : \" + questionURL);\r\n                    var tempTask = new JSONtask1;\r\n                    var parsedJSON = JSON.parse(textAsset.toString());\r\n                    tempTask.question = parsedJSON[\"question\"];\r\n                    tempTask.tacanOdgovor = parsedJSON[\"tacanOdgovor\"];\r\n                    \r\n                    if(parsedJSON[\"netacanOdgovor1\"] != undefined) {\r\n                        tempTask.netacanOdgovor1 = parsedJSON[\"netacanOdgovor1\"];\r\n                        tempTask.netacanOdgovor2 = parsedJSON[\"netacanOdgovor2\"];\r\n                    }                    \r\n                    \r\n                    if( parsedJSON[\"questionAudio\"] != undefined)  {\r\n\r\n                        console.log(\"Sta je : parsedJSON[questionAudio] \" + parsedJSON[\"questionAudio\"]);\r\n\r\n                        try {\r\n                            //tasksInProgress++;\r\n                            //console.log(\"Task Added 4\");\r\n                            assetManager.loadRemote<AudioClip>(remoteUrlRoot + parsedJSON[\"questionAudio\"], (AudioClip), (err, audioClip) =>  {\r\n                                tempTask.questionAudio =  audioClip ;\r\n                                //tasksInProgress--;\r\n                                //console.log(\"Task reduced 4\");\r\n                            });\r\n\r\n                        } catch (error) {\r\n                            console.log(\"Zvuk nije dobro ucitan\");\r\n                            tempTask.audioIsLoaded = false;\r\n                        } \r\n                    } else \r\n                        console.log(\"Ne postoje zvukovi za ovu putanju\");\r\n                        \r\n                    \r\n                    if(tempTask.question != undefined)\r\n                        taskJSON.push(tempTask);\r\n\r\n                    tasksInProgress--;\r\n                    console.log(\"Task reduced 3\" + questionURL);\r\n                } catch (error) {\r\n                    console.log(\"Nisam nasao trazeno polje za parsiranje\" + error );\r\n                    return false;\r\n                }\r\n            });\r\n            return true;\r\n        } catch (error) {\r\n            console.log(\"Nisam nasao trazenu adresu za parsiranje 2\" + error );\r\n            return false;\r\n        }\r\n        \r\n\r\n    }\r\n    update() {\r\n        if( this.downloadInProgress == true && tasksInProgress == 0) {\r\n            this.downloadInProgress = false;\r\n            GameManager.getInstance().downloadedCheckpoint++;\r\n        }\r\n\r\n        GameManager.instance.taskInProgressManager = Number( tasksInProgress);\r\n        \r\n    }\r\n\r\n    fetchQuestTekst(questURL: string, tekstObject: JSONquestTekst) {\r\n        this.downloadInProgress = true;\r\n\r\n        let remoteUrlRoot = this.originUrl + \"/\" + this.gameManager?.LanguageName + \"/\" + this.gameManager?.LevelName + \"/\" + questURL ;\r\n        var audioURL = this.originUrl + \"/\" + this.gameManager?.LanguageName + \"/\" + this.gameManager?.LevelName + \"/\";\r\n        //let questURLfull = remoteUrlRoot \r\n\r\n        try {\r\n\r\n            tasksInProgress++;\r\n            console.log(\"Task Added 5\");\r\n            assetManager.loadRemote(remoteUrlRoot, function (err, textAsset) {\r\n\r\n                try {\r\n\r\n                   var parsedJSON = JSON.parse(textAsset.toString());\r\n\r\n                   tekstObject.quest = parsedJSON[\"quest\"];\r\n                   \r\n                   if( parsedJSON[\"questAudio\"] != undefined)  {\r\n                        \r\n                       try {\r\n                            //tasksInProgress++;\r\n                                //console.log(\"Task Added 6\");\r\n                           assetManager.loadRemote<AudioClip>(audioURL + parsedJSON[\"questAudio\"], (AudioClip), (err, audioClip) =>  {\r\n                            tekstObject.questAudio =  audioClip ;\r\n                            //tasksInProgress--;\r\n                            //console.log(\"Task reduced 6\");\r\n                           });\r\n                        \r\n                       } catch (error) {\r\n                           console.log(\"Zvuk nije dobro ucitan\");\r\n                           tekstObject.audioIsLoaded = false;\r\n                       } \r\n                   } else \r\n                       console.log(\"Ne postoje zvukovi za ovu putanju\");\r\n\r\n\r\n                    tasksInProgress--;\r\nconsole.log(\"Task reduced 5\");\r\n               } catch (error) {\r\n                   console.log(\"Nisam nasao trazeno polje za parsiranje\" + error );\r\n                   return false;\r\n               }\r\n           });\r\n           return true;\r\n       } catch (error) {\r\n           console.log(\"Nisam nasao trazenu adresu za parsiranje 2\" + error );\r\n           return false;\r\n       }\r\n    }\r\n\r\n    \r\n    fetchImageQuestTekst(questURL: string, imageObject: JSONimage) {\r\n        this.downloadInProgress = true;\r\n\r\n        let remoteUrlRoot = this.originUrl + \"/\" + this.gameManager?.LanguageName + \"/\" + this.gameManager?.LevelName + \"/\" + questURL ;\r\n        var rootURL = this.originUrl + \"/\" + this.gameManager?.LanguageName + \"/\" + this.gameManager?.LevelName + \"/\";\r\n        //let questURLfull = remoteUrlRoot \r\n\r\n        try {\r\n            tasksInProgress++;\r\n            console.log(\"Task Added 7\");\r\n            assetManager.loadRemote(remoteUrlRoot, function (err, textAsset) {\r\n\r\n                try {\r\n\r\n                   var parsedJSON = JSON.parse(textAsset.toString());\r\n\r\n                   imageObject.quest = parsedJSON[\"quest\"];\r\n                   \r\n                   if( parsedJSON[\"questImage\"] != undefined)  {\r\n\r\n                    tasksInProgress++;\r\n                    console.log(\"Task Added 9\");\r\n\r\n                    try {\r\n                        assetManager.loadRemote<ImageAsset>(rootURL + parsedJSON[\"questImage\"], (err, fetchedImage) =>  {\r\n                            console.log(\"Sta skidam \" + rootURL + parsedJSON[\"questImage\"]);\r\n                            \r\n                            const spriteFrame = new SpriteFrame();\r\n                            const texture = new Texture2D();\r\n                            texture.image = fetchedImage;\r\n                            spriteFrame.texture = texture;\r\n                            imageObject.questImage = spriteFrame ;\r\n\r\n                            tasksInProgress--;\r\n                            console.log(\"Task reduced 9\");\r\n\r\n                        });\r\n                     \r\n                    } catch (error) {\r\n                        console.log(\"Slika nije dobro ucitana\");\r\n                        imageObject.audioIsLoaded = false;\r\n                    } \r\n                } else \r\n                    console.log(\"Ne postoji slika za ovu putanju\");\r\n\r\n                    \r\n                   if( parsedJSON[\"questAudio\"] != undefined)  {\r\n\r\n                       try {\r\n                            //tasksInProgress++;\r\n                            //console.log(\"Task Added 8\");\r\n                           assetManager.loadRemote<AudioClip>(rootURL + parsedJSON[\"questAudio\"], (AudioClip), (err, audioClip) =>  {\r\n                            imageObject.questAudio =  audioClip ;\r\n                            //tasksInProgress--;\r\n                            //console.log(\"Task reduced 8\");\r\n                           });\r\n                        \r\n                       } catch (error) {\r\n                           console.log(\"Zvuk nije dobro ucitan\");\r\n                           imageObject.audioIsLoaded = false;\r\n                       } \r\n                   } else \r\n                       console.log(\"Ne postoje zvukovi za ovu putanju\");\r\n\r\n\r\n                    \r\n\r\n                    tasksInProgress--;\r\nconsole.log(\"Task reduced 7\");\r\n               } catch (error) {\r\n                   console.log(\"Nisam nasao trazeno polje za parsiranje\" + error );\r\n                   return false;\r\n               }\r\n           });\r\n           return true;\r\n       } catch (error) {\r\n           console.log(\"Nisam nasao trazenu adresu za parsiranje 2\" + error );\r\n           return false;\r\n       }\r\n\r\n       \r\n    }\r\n\r\n    \r\n    \r\n}\r\n\r\nexport class JSONtask2 {\r\n    \r\n    type?: string;\r\n    question?: string;\r\n    questionAudio? : AudioClip;\r\n    tacanOdgovor?: string;\r\n    tacanOdgovorAudio? : AudioClip;\r\n\r\n    audioIsLoaded? : boolean;\r\n\r\n    constructor( ) {\r\n        this.type = \"\";\r\n        this.question = \"\";\r\n        this.questionAudio = undefined;\r\n        this.tacanOdgovor = \"\";\r\n        this.tacanOdgovorAudio = undefined;\r\n\r\n        this.audioIsLoaded = true;\r\n    }\r\n\r\n}\r\n\r\nexport class JSONtask1 {\r\n    \r\n    type?: string;\r\n    question?: string;\r\n    questionAudio? : AudioClip;\r\n    tacanOdgovor?: string;\r\n    tacanOdgovorAudio? : AudioClip;\r\n    netacanOdgovor1?: string;\r\n    netacanOdgovor1Audio? : AudioClip;\r\n    netacanOdgovor2?: string;\r\n    netacanOdgovor2Audio? : AudioClip;\r\n    audioIsLoaded? : boolean;\r\n\r\n    constructor( ) {\r\n        this.type = \"\";\r\n        this.question = \"\";\r\n        this.questionAudio = undefined;\r\n        this.tacanOdgovor = \"\";\r\n        this.tacanOdgovorAudio = undefined;\r\n        this.netacanOdgovor1 = \"\";\r\n        this.netacanOdgovor1 = undefined;\r\n        this.netacanOdgovor2 = \"\";\r\n        this.netacanOdgovor2 = undefined;\r\n        this.audioIsLoaded = true;\r\n    }\r\n\r\n}\r\nexport class JSONobject {\r\n    quest?: string;\r\n    questImage?: SpriteFrame;\r\n    questAudio? : AudioClip;\r\n    audioIsLoaded? : boolean;\r\n\r\n    constructor( ) {\r\n        this.quest = undefined;\r\n        this.questImage = undefined;\r\n        this.questAudio = undefined;\r\n        this.audioIsLoaded = true;\r\n    }\r\n}\r\n\r\nexport class JSONquestTekst extends JSONobject{\r\n    \r\n    quest?: string;\r\n\r\n    constructor( ) {\r\n        super();\r\n        this.quest = \"\";\r\n    }\r\n}\r\n\r\nexport class JSONimage extends JSONobject {\r\n    \r\n    quest?: string;\r\n    questImage?: SpriteFrame;\r\n\r\n\r\n    constructor( ) {\r\n        super();\r\n        this.quest = \"\";\r\n        this.questImage = undefined;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}