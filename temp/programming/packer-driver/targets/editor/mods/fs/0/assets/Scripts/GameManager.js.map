{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/GameManager.ts"],"names":["_decorator","Component","Node","director","Label","sys","AudioSource","find","DetectTypeOfDevice","DetectTypeOfDeviceElevator","elevator","GlobalManager","JSONloader","LoadingHandler","ccclass","property","GameStatuType","GameManager","Boolean","String","gameTutorial","getInstance","instance","console","log","start","getComponent","volume","play","puttingThingsTogether","onLoad","elevatorScript","startProgress","Number","activeLevelData","getLevelProgress","detectType","LanguageName","localAudioSource","jsonLoader","node","loadingHandler","typeInputResult","Canvas","getChildByName","trophies","setPlatformType","setTheKeyboard","isMobileOrTablet","active","getTaskManager","TaskManager","inputKeyboard","settingsUI","os","OS","ANDROID","IOS","platform","Platform","MOBILE_BROWSER","backToMenu","findGeneralProgress","levelsArray","length","setLevelProgress","debugMode","loadScene","projectNumber","toString"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, AudioClip, director, Label, sys, AudioSource, Scene, LightComponent, find, loader, assetManager, Game } from 'cc';\r\nimport { DetectTypeOfDevice } from './DetectTypeOfDevice';\r\nimport { DetectTypeOfDeviceElevator } from './DetectTypeOfDeviceElevator';\r\nimport { elevator, GlobalManager, levelObject } from './GlobalManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = GameManager\r\n * DateTime = Tue Nov 30 2021 13:26:28 GMT+0100 (Central European Standard Time)\r\n * Author = stickandrope\r\n * FileBasename = GameManager.ts\r\n * FileBasenameNoExtension = GameManager\r\n * URL = db://assets/Scripts/GameManager.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n\r\n */\r\nimport { JSONloader } from \"./RemoteScripts/JSONloader\";\r\nimport { LoadingHandler } from './RemoteScripts/LoadingHandler';\r\n\r\n\r\n/*\r\nvar localSceneData = new  levelObject();\r\nexport { localSceneData };\r\n*/\r\n\r\n export enum GameStatuType {\r\n    gamePaused =    0,\r\n    gameActive =   1,\r\n    gameTutorial =   2,\r\n    }\r\n\r\n@ccclass('GameManager')\r\nexport class GameManager extends Component {\r\n\r\n    gameStatus? : GameStatuType = GameStatuType.gameTutorial;\r\n    typeInputResult? : Label ;\r\n    jsonLoader? : JSONloader ;\r\n    loadingHandler? : LoadingHandler;\r\n\r\n    @property(Boolean)\r\n    elevatorScript = false;\r\n\r\n    inputKeyboard? : Node ;\r\n\r\n    settingsUI? : Node;\r\n\r\n    localAudioSource? : AudioSource;\r\n\r\n    @property(Node)\r\n    Canvas?: Node;\r\n\r\n    @property(Node)\r\n    WorldRoot?: Node;\r\n\r\n    @property(Node)\r\n    TaskManager?: Node;\r\n\r\n    @property(Node)\r\n    Player?: Node;\r\n\r\n    @property(String)\r\n    LevelName?: String;\r\n\r\n    @property(String)\r\n    LanguageName?: String;\r\n\r\n    moveSpeed : number = 1.5;\r\n    invertedRotation : boolean = false;\r\n\r\n    isMobileOrTablet : boolean = false;\r\n\r\n    taskInProgressManager : number = 1;\r\n\r\n    downloadedCheckpoint : number = 0;\r\n\r\n    audioArray?: Array<AudioSource> = [];\r\n\r\n    trophies? : Node ;\r\n\r\n    startProgress: number = 0;\r\n\r\n\r\n    detectType: DetectTypeOfDevice | DetectTypeOfDeviceElevator | undefined ;\r\n\r\n    debugMode = false;\r\n\r\n    public static getInstance(): GameManager {\r\n        if (!GameManager.instance) {\r\n            console.log(\"LATE INSTANCE\");\r\n\r\n        }\r\n        return GameManager.instance;\r\n    }\r\n\r\n    static instance: GameManager;\r\n\r\n\r\n\r\n    start() {\r\n        this.getComponent(AudioSource)!.volume = GlobalManager.volume;\r\n        this.getComponent(AudioSource)!.play();\r\n\r\n  \r\n    }\r\n\r\n\r\n    puttingThingsTogether() {\r\n\r\n    }\r\n\r\n    onLoad() {\r\n        GameManager.instance = this;\r\n\r\n        if(this.elevatorScript) {\r\n\r\n            this.startProgress = Number(GlobalManager.getInstance().activeLevelData!.getLevelProgress());\r\n            \r\n            console.log(\"1  \", find(\"Canvas\"));\r\n            console.log(\"2  \", find(\"Canvas\")!.getComponent(DetectTypeOfDeviceElevator));\r\n            \r\n            this.detectType = find(\"Canvas\")!.getComponent(DetectTypeOfDeviceElevator)!;\r\n        \r\n        } // this.Player!.getComponent(FirstPersonCameraMovementElevator)!;\r\n        else {\r\n            console.log(\"3  \", find(\"Canvas\")!.getComponent(DetectTypeOfDevice));\r\n            this.detectType = find(\"Canvas\")!.getComponent(DetectTypeOfDevice)!; \r\n        }\r\n\r\n        this.LanguageName = GlobalManager.getInstance().LanguageName;\r\n        \r\n        \r\n\r\n        this.localAudioSource = this.getComponent(AudioSource)!;\r\n\r\n\r\n        this.jsonLoader = this.node.getComponent(JSONloader)!;\r\n        this.loadingHandler = this.node.getComponent(LoadingHandler)!;\r\n\r\n        this.typeInputResult = this.Canvas?.getChildByName(\"GenericUI-Input\")?.getChildByName(\"EditBoxPC\")?.getChildByName(\"Result\")!.getComponent(Label)!;\r\n    \r\n        this.trophies = this.Canvas!.getChildByName(\"BottomUI\")!.getChildByName(\"TrofejiLayout\")!;\r\n\r\n\r\n        this.setPlatformType();\r\n    }\r\n\r\n    setTheKeyboard() {\r\n        if(this.isMobileOrTablet) {\r\n\r\n            this.Canvas!.getChildByName(\"GenericUI-Input\")!.getChildByName(\"EditBox\")!.active = true;\r\n            this.Canvas!.getChildByName(\"GenericUI-Input\")!.getChildByName(\"EditBoxPC\")!.active = false;\r\n\r\n            this.typeInputResult = this.Canvas!.getChildByName(\"GenericUI-Input\")!.getChildByName(\"EditBox\")!.getChildByName(\"Result\")!.getComponent(Label)!\r\n\r\n        } else {\r\n            this.Canvas!.getChildByName(\"GenericUI-Input\")!.getChildByName(\"EditBox\")!.active = false;\r\n            this.Canvas!.getChildByName(\"GenericUI-Input\")!.getChildByName(\"EditBoxPC\")!.active = true;\r\n\r\n            this.typeInputResult = this.Canvas!.getChildByName(\"GenericUI-Input\")!.getChildByName(\"EditBoxPC\")!.getChildByName(\"Result\")!.getComponent(Label)!\r\n        }\r\n    }\r\n\r\n    getTaskManager(){\r\n        return this.TaskManager;\r\n    }\r\n\r\n\r\n\r\n\r\n    setPlatformType() {\r\n        this.inputKeyboard = this.Canvas!.getChildByName(\"BottomUI\")!.getChildByName(\"Keyboard\")!;\r\n        this.settingsUI = this.Canvas!.getChildByName(\"Settings\")!;\r\n \r\n        if(sys.os == sys.OS.ANDROID || sys.os == sys.OS.IOS || sys.platform == sys.Platform.MOBILE_BROWSER) \r\n            this.isMobileOrTablet = true;\r\n\r\n        this.setTheKeyboard();\r\n    }\r\n\r\n\r\n\r\n    backToMenu() {\r\n        GlobalManager.getInstance().activeLevelData =  elevator; //  this.findSceneDataByName(\"MainMenuLift1\");\r\n        if(GlobalManager.getInstance().findGeneralProgress() != GlobalManager.getInstance().levelsArray.length)\r\n            GlobalManager.getInstance().activeLevelData.setLevelProgress(2);\r\n        else\r\n            GlobalManager.getInstance().activeLevelData.setLevelProgress(4);\r\n\r\n\r\n        if(this.debugMode == true)\r\n            director.loadScene(\"MainMenu\");\r\n        else {\r\n            GlobalManager.getInstance().activeLevelData = elevator;\r\n            director.loadScene(\"MainMenuLift\"+ GlobalManager.getInstance().projectNumber.toString());\r\n            //director.loadScene(\"MainMenuLift1\");\r\n        }\r\n            \r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n"]}