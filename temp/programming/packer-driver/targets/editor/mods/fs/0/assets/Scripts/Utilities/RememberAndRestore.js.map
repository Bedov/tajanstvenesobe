{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/Utilities/RememberAndRestore.ts"],"names":["NodePosRot","_decorator","Component","Node","Vec3","Quat","RigidBody","Animation","GlobalManager","Trigger1","ccclass","property","RememberAndRestore","start","animatedObjects","getComponent","isStatic","forEach","element","nodePosRot","node","position","rotation","objectsNodePosRot","push","scheduleOnce","setActive","onLoad","index","parentObjects","length","children","active","console","log","getInstance","findGeneralProgress","name","restart","stop","setPosition","setRotation","clearVelocity","clearForces","triggersToRestart","animationPlayed"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, Vec3, Quat, RigidBody, Animation } from 'cc';\nimport { GlobalManager } from '../GlobalManager';\nimport { Trigger1 } from '../Goldberg/Trigger1';\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = RememberAndRestore\n * DateTime = Thu Mar 31 2022 13:41:55 GMT+0200 (Central European Summer Time)\n * Author = stickandrope\n * FileBasename = RememberAndRestore.ts\n * FileBasenameNoExtension = RememberAndRestore\n * URL = db://assets/Scripts/Utilities/RememberAndRestore.ts\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\n *\n */\n \n@ccclass('RememberAndRestore')\nexport class RememberAndRestore extends Component {\n    // [1]\n    // dummy = '';\n\n    \n    @property([Node])\n    animatedObjects: Node[] = [];\n\n    objectsNodePosRot: NodePosRot[] = [];\n\n    @property([Node])\n    parentObjects: Node[] = [];\n        \n    @property([Trigger1])\n    triggersToRestart: Trigger1[] = [];\n\n    start () {\n        this.animatedObjects[0].getComponent(RigidBody)!.isStatic = true;\n\n        this.animatedObjects.forEach(element => {\n            var nodePosRot = new NodePosRot;\n            nodePosRot.node = element;\n            nodePosRot.position = new Vec3( element.position);\n            nodePosRot.rotation = new Quat(element.rotation) ;\n\n            this.objectsNodePosRot.push(nodePosRot);\n\n            \n        });\n\n        this.scheduleOnce(this.setActive, 0.5);\n\n        //this.setActive();\n    }\n\n    onLoad() {\n\n    }\n\n    setActive() {\n        for (let index = 0; index < this.parentObjects.length; index++) {\n            if(this.parentObjects[index].children != null)\n                this.parentObjects[index].children.forEach(element => {\n                    element.active = true;\n                });\n            \n            this.parentObjects[index].active = true;\n        }\n\n        console.log(\"General Progress: \" + GlobalManager.getInstance().findGeneralProgress());\n        \n\n        for (let index = GlobalManager.getInstance().findGeneralProgress(); index < this.parentObjects.length; index++) {\n            if(this.parentObjects[index].children != null)\n                this.parentObjects[index].children.forEach(element => {\n                    element.active = false;\n                    console.log(\"Gasim element \" + element.name);\n                    \n                });\n        \n        this.parentObjects[index].active = false;\n        console.log(\"Gasim element \" + this.parentObjects[index].name);\n\n        }\n    }\n\n    restart() {\n        this.animatedObjects[0].getComponent(RigidBody)!.isStatic = false;\n\n        this.objectsNodePosRot.forEach(element => {\n            if( element.node.getComponent(Animation))\n                element.node.getComponent(Animation)?.stop();\n\n            element.node.setPosition(element.position!);\n            element.node.setRotation(element.rotation!);\n\n            if( element.node.getComponent(RigidBody)) {\n                element.node.getComponent(RigidBody)?.clearVelocity();\n                element.node.getComponent(RigidBody)?.clearForces();\n            }\n        });\n\n        this.triggersToRestart.forEach(element => {\n            element.animationPlayed = false;\n        });\n    }\n\n\n}\n\nexport class NodePosRot {\n    node!: Node;\n    position?: Vec3;\n\n    rotation? : Quat;\n\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/decorator.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\n */\n"]}