{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/Tasks/TaskABCquestion.ts"],"names":["_decorator","AudioSource","randomRangeInt","GenericUIABC","Task","GameManager","ccclass","property","TaskABCquestion","String","Number","Array","start","schedule","isItMyTimeForDownloading","audioSource","node","getComponent","scheduleOnce","fillQuestionsShownFalse","orderNumber","getInstance","downloadedCheckpoint","downloadStarted","getQuestions","questionsTempArray","forEach","element","questionsShown","push","remoteName","jsonLoader","fetchQuestions","expectedQuestions","getRandomTask","imamoNekoriscene","nasaoNekoriscenog","randomIndex","length","console","log","showTask","isItOkToExecute","loadingHandler","turnOnLoading","turnOffLoading","taskManager","genericUIABC","active","turnOnGenericTask"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, AudioSource, director, Collider, Animation, random, randomRangeInt, Game } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\nimport { TaskManager } from \"./TaskManager\";\r\nimport { ScriptEffects } from \"../Utilities/ScriptEffects\";\r\nimport { GenericUI } from \"../Utilities/GenericUI\";\r\nimport { GenericUIABC } from \"../Utilities/GenericUI-ABC\";\r\nimport { Task } from './Task';\r\n\r\nimport { JSONloader } from \"../RemoteScripts/JSONloader\";\r\nimport { JSONtask1 } from \"../RemoteScripts/JSONloader\";\r\nimport { GameManager } from '../GameManager';\r\n@ccclass('TaskABCquestion')\r\nexport class TaskABCquestion extends Task {\r\n\r\n    @property(String)\r\n    remoteName!: String;\r\n\r\n    @property(Number)\r\n    expectedQuestions!: Number;\r\n\r\n    \r\n\r\n    questionsTempArray : Array<JSONtask1> = new Array<JSONtask1>();\r\n\r\n    questionsShown : Array<boolean> = new Array<boolean>();\r\n    questionShownFilled = false;\r\n\r\n    private audioSource: AudioSource = null!;\r\n   \r\n\r\n    start () {\r\n       // this.scheduleOnce(this.getQuestions, this.orderNumber * 0.05);\r\n\r\n       this.schedule(this.isItMyTimeForDownloading, 0.1);\r\n       \r\n\r\n        this.audioSource = this.node.getComponent(AudioSource)!;\r\n\r\n\r\n        \r\n        this.scheduleOnce(this.fillQuestionsShownFalse, this.orderNumber * 0.05 + 2);\r\n    }\r\n\r\n    isItMyTimeForDownloading() {\r\n\r\n        if(this.orderNumber <= GameManager.getInstance().downloadedCheckpoint && !this.downloadStarted) {\r\n            this.getQuestions();\r\n            this.downloadStarted = true;\r\n        }\r\n    }\r\n\r\n    fillQuestionsShownFalse() {\r\n        this.questionsTempArray.forEach(element => {\r\n            this.questionsShown.push(false);\r\n             \r\n        });\r\n    }\r\n\r\n    getQuestions() {\r\n        if(this.remoteName != \"\") {\r\n            GameManager.getInstance().jsonLoader?.fetchQuestions(this.remoteName, this.questionsTempArray, this.expectedQuestions)!;\r\n        }\r\n    }\r\n\r\n\r\n    getRandomTask() {\r\n        var imamoNekoriscene = false;\r\n        var nasaoNekoriscenog = false;\r\n        var randomIndex = randomRangeInt(0, this.questionsShown.length);\r\n        \r\n\r\n        this.questionsShown.forEach(element => {\r\n            if(element == false)\r\n                imamoNekoriscene = true;\r\n        });\r\n\r\n        console.log(\"imamoNekoriscene: \" + imamoNekoriscene);\r\n        \r\n        if(imamoNekoriscene) {\r\n            while(!nasaoNekoriscenog) {\r\n                randomIndex = randomRangeInt(0, this.questionsShown.length);\r\n                if( !this.questionsShown[randomIndex])\r\n                    nasaoNekoriscenog = true;\r\n            }\r\n            \r\n        }\r\n        console.log(\"QUESTION ARRAY LENGHT\" +  this.questionsShown.length);\r\n        console.log(\"randomIndex: \" + randomIndex);\r\n\r\n        this.questionsShown[randomIndex] = true;\r\n\r\n        return this.questionsTempArray[randomIndex];\r\n    }\r\n\r\n    showTask () {\r\n        console.log(\"ShowTask!!!\");\r\n        if(this.isItOkToExecute()) {\r\n            if(GameManager.getInstance().downloadedCheckpoint <= this.orderNumber) {\r\n                GameManager.getInstance().loadingHandler?.turnOnLoading();\r\n                this.scheduleOnce(this.showTask, 0.2);\r\n                console.log(\"DownloadedCheckpoint : \" + GameManager.getInstance().downloadedCheckpoint);\r\n    \r\n                console.log(\"this.orderNumber : \" + this.orderNumber);\r\n                return;\r\n            }\r\n            \r\n            GameManager.getInstance().loadingHandler?.turnOffLoading();\r\n            this.taskManager.genericUIABC!.active = true;\r\n            this.taskManager.genericUIABC!.getComponent(GenericUIABC)!.turnOnGenericTask(this.node); //Čestitam! Stigao si do časovničara.\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}