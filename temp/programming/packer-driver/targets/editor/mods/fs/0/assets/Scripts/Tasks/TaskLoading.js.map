{"version":3,"sources":["file:///Users/aleksandarbedov/Documents/CocosCreator/tajanstvenesobe2/assets/Scripts/Tasks/TaskLoading.ts"],"names":["_decorator","macro","Task","ScriptEffects","GameManager","GameStatuType","DetectTypeOfDevice","ccclass","property","TaskLoading","start","getInstance","downloadedCheckpoint","schedule","checkExecution","REPEAT_FOREVER","checkIfDownloadIsCompleted","showTask","gameStatus","gameActive","gamePaused","taskManager","loadingPanel","getComponent","fadeInActive","isItOkToExecute","canvas","_moveTutorialEndBool","_lookTutorialEndBool","executed","console","log","instance","taskInProgressManager","fadeOutActive","loadingCompleted","taskCompleted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAA6BC,MAAAA,K,OAAAA,K;;AAC7BC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,a,iBAAAA,a;;AAEAC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,a,iBAAAA,a;;AACbC,MAAAA,kB,iBAAAA,kB;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;6BAGaS,W,WADZF,OAAO,CAAC,aAAD,C,yBAAR,MACaE,WADb;AAAA;AAAA,wBACsC;AAAA;AAAA;;AAAA,oDAEf,KAFe;AAAA;;AAIlCC,QAAAA,KAAK,GAAI;AACL;AAAA;AAAA,0CAAYC,WAAZ,GAA0BC,oBAA1B;AACA,eAAKC,QAAL,CAAc,KAAKC,cAAnB,EAAmC,GAAnC,EAAwCb,KAAK,CAACc,cAA9C;AACA,eAAKF,QAAL,CAAc,KAAKG,0BAAnB,EAA+C,GAA/C,EAAoDf,KAAK,CAACc,cAA1D;AACH;;AAEDE,QAAAA,QAAQ,GAAG;AACP,gBAAMA,QAAN;AAEA,cAAG;AAAA;AAAA,0CAAYN,WAAZ,GAA0BO,UAA1B,IAAwC;AAAA;AAAA,8CAAcC,UAAzD,EACI;AAAA;AAAA,0CAAYR,WAAZ,GAA0BO,UAA1B,GAAuC;AAAA;AAAA,8CAAcE,UAArD;AACJ,eAAKC,WAAL,CAAiBC,YAAjB,CAA+BC,YAA/B;AAAA;AAAA,8CAA4DC,YAA5D;AACH;;AAEDV,QAAAA,cAAc,GAAG;AAAA;;AACb,cAAG,KAAKW,eAAL,gCAA0B,KAAKJ,WAAL,CAAiBK,MAA3C,oFAA0B,sBAAyBH,YAAzB;AAAA;AAAA,uDAA1B,2DAA0B,uBAA2DI,oBAArF,gCAA6G,KAAKN,WAAL,CAAiBK,MAA9H,qFAA6G,uBAAyBH,YAAzB;AAAA;AAAA,uDAA7G,2DAA6G,uBAA2DK,oBAAxK,KAAgM,CAAC,KAAKC,QAAzM,EACI,KAAKZ,QAAL;AACP;;AAEDD,QAAAA,0BAA0B,GAAE;AAAA;;AACxBc,UAAAA,OAAO,CAACC,GAAR,CAAY,gDAAgD;AAAA;AAAA,0CAAYC,QAAZ,CAAqBC,qBAAjF;;AAEA,cAAK;AAAA;AAAA,0CAAYD,QAAZ,CAAqBC,qBAArB,IAA+C,CAApD,EAAuD;AACnD,iBAAKZ,WAAL,CAAiBC,YAAjB,CAA+BC,YAA/B;AAAA;AAAA,gDAA4DW,aAA5D;AACA,gBAAG;AAAA;AAAA,4CAAYvB,WAAZ,GAA0BO,UAA1B,IAAwC;AAAA;AAAA,gDAAcE,UAAzD,EACI;AAAA;AAAA,4CAAYT,WAAZ,GAA0BO,UAA1B,GAAuC;AAAA;AAAA,gDAAcC,UAArD;AACJ,iBAAKgB,gBAAL,GAAwB,IAAxB;AAEH;;AAED,cAAG,gCAAKd,WAAL,CAAiBK,MAAjB,4GAAyBH,YAAzB;AAAA;AAAA,yIAA2DI,oBAA3D,gCAAmF,KAAKN,WAAL,CAAiBK,MAApG,qFAAmF,uBAAyBH,YAAzB;AAAA;AAAA,uDAAnF,2DAAmF,uBAA2DK,oBAA9I,KAAsK,CAAC,KAAKC,QAA5K,IAAwL,KAAKM,gBAAhM,EACA,KAAKC,aAAL;AAEH;;AArCiC,O;AA0CtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["\r\nimport { _decorator, Component, Node, macro, Game } from 'cc';\r\nimport { Task } from './Task';\r\nimport { ScriptEffects } from \"../Utilities/ScriptEffects\";\r\nimport { JSONloader } from '../RemoteScripts/JSONloader';\r\nimport { GameManager, GameStatuType } from '../GameManager';\r\nimport { DetectTypeOfDevice } from '../DetectTypeOfDevice';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = TaskLoading\r\n * DateTime = Thu Mar 17 2022 23:31:16 GMT+0100 (Central European Standard Time)\r\n * Author = stickandrope\r\n * FileBasename = TaskLoading.ts\r\n * FileBasenameNoExtension = TaskLoading\r\n * URL = db://assets/Scripts/Tasks/TaskLoading.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\r\n *\r\n */\r\n \r\n@ccclass('TaskLoading')\r\nexport class TaskLoading extends Task {\r\n\r\n    loadingCompleted = false;\r\n\r\n    start () {\r\n        GameManager.getInstance().downloadedCheckpoint++;\r\n        this.schedule(this.checkExecution, 0.1, macro.REPEAT_FOREVER);\r\n        this.schedule(this.checkIfDownloadIsCompleted, 0.1, macro.REPEAT_FOREVER);\r\n    }\r\n\r\n    showTask() {\r\n        super.showTask();\r\n\r\n        if(GameManager.getInstance().gameStatus == GameStatuType.gameActive)\r\n            GameManager.getInstance().gameStatus = GameStatuType.gamePaused;\r\n        this.taskManager.loadingPanel!.getComponent(ScriptEffects)!.fadeInActive();\r\n    }\r\n\r\n    checkExecution() {\r\n        if(this.isItOkToExecute() && this.taskManager.canvas?.getComponent(DetectTypeOfDevice)?._moveTutorialEndBool && this.taskManager.canvas?.getComponent(DetectTypeOfDevice)?._lookTutorialEndBool && !this.executed)\r\n            this.showTask();\r\n    }\r\n\r\n    checkIfDownloadIsCompleted(){\r\n        console.log(\"GameManager.instance.taskInProgressManager \" + GameManager.instance.taskInProgressManager );\r\n        \r\n        if(  GameManager.instance.taskInProgressManager  == 0) {\r\n            this.taskManager.loadingPanel!.getComponent(ScriptEffects)!.fadeOutActive();\r\n            if(GameManager.getInstance().gameStatus == GameStatuType.gamePaused)\r\n                GameManager.getInstance().gameStatus = GameStatuType.gameActive;\r\n            this.loadingCompleted = true;\r\n            \r\n        }\r\n\r\n        if(this.taskManager.canvas?.getComponent(DetectTypeOfDevice)?._moveTutorialEndBool && this.taskManager.canvas?.getComponent(DetectTypeOfDevice)?._lookTutorialEndBool && !this.executed && this.loadingCompleted)\r\n        this.taskCompleted();\r\n        \r\n    }\r\n\r\n\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}